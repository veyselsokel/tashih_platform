import{G as p,d as r,b as e,m as u,x as g,H as h,F as f,e as b,k as m,i as x,n as y,t as d,a}from"./app-A8zMFDdo.js";import{_ as k}from"./_plugin-vue_export-helper-DlAUqK2U.js";const v={data(){return{newProduct:{url:"",store:"zara",targetPrice:null},products:[],emailSettings:{email:"",appPassword:""},isMonitoring:!1,loading:!1,statusCheckInterval:null,logs:[],notification:{show:!1,type:"info",title:"",message:"",timeout:null}}},mounted(){this.loadFromLocalStorage(),this.checkMonitoringStatus()},beforeUnmount(){this.statusCheckInterval&&clearInterval(this.statusCheckInterval)},methods:{addProduct(){if(!this.newProduct.url||!this.newProduct.targetPrice){this.showNotification("error","Eksik Bilgi","Lütfen URL ve hedef fiyat giriniz.");return}this.products.push({url:this.newProduct.url,store:this.newProduct.store,targetPrice:parseFloat(this.newProduct.targetPrice),lastPrice:null,lastCheck:null}),this.newProduct={url:"",store:"zara",targetPrice:null},this.saveToLocalStorage(),this.showNotification("success","Ürün Eklendi","Yeni ürün takip listesine eklendi.")},removeProduct(i){confirm("Bu ürünü takipten çıkarmak istediğinize emin misiniz?")&&(this.products.splice(i,1),this.saveToLocalStorage(),this.showNotification("info","Ürün Silindi","Ürün takip listesinden çıkarıldı."))},saveEmailSettings(){if(!this.emailSettings.email){this.showNotification("error","Eksik Bilgi","Lütfen bir email adresi giriniz.");return}if(!this.emailSettings.appPassword){this.showNotification("error","Eksik Bilgi","Lütfen App Password giriniz.");return}this.saveToLocalStorage(),this.showNotification("success","Ayarlar Kaydedildi","Email ayarları başarıyla kaydedildi.")},async startMonitoring(){var i,t;if(this.products.length===0){this.showNotification("error","Ürün Yok","Takip edilecek ürün bulunmuyor. Lütfen önce ürün ekleyin.");return}if(!this.emailSettings.email||!this.emailSettings.appPassword){this.showNotification("error","Eksik Ayarlar","Lütfen önce email ayarlarınızı tamamlayın.");return}this.loading=!0;try{const n=await p.post("/fiyat-takip/start",{products:this.products,email:this.emailSettings.email,appPassword:this.emailSettings.appPassword});n.data.status==="success"?(this.isMonitoring=!0,this.showNotification("success","Takip Başlatıldı","Fiyat takibi başarıyla başlatıldı."),this.startStatusChecking()):this.showNotification("error","Hata",n.data.message||"Fiyat takibi başlatılamadı.")}catch(n){console.error("Fiyat takibi başlatma hatası:",n),this.showNotification("error","Hata",((t=(i=n.response)==null?void 0:i.data)==null?void 0:t.message)||"Bir hata oluştu. Lütfen tekrar deneyin.")}finally{this.loading=!1}},async stopMonitoring(){var i,t;this.loading=!0;try{const n=await p.post("/fiyat-takip/stop");n.data.status==="success"?(this.isMonitoring=!1,this.showNotification("info","Takip Durduruldu","Fiyat takibi durduruldu."),this.statusCheckInterval&&(clearInterval(this.statusCheckInterval),this.statusCheckInterval=null)):this.showNotification("error","Hata",n.data.message||"Fiyat takibi durdurulamadı.")}catch(n){console.error("Fiyat takibi durdurma hatası:",n),this.showNotification("error","Hata",((t=(i=n.response)==null?void 0:i.data)==null?void 0:t.message)||"Bir hata oluştu. Lütfen tekrar deneyin.")}finally{this.loading=!1}},async checkMonitoringStatus(){try{const i=await p.get("/fiyat-takip/status");this.isMonitoring=i.data.isRunning,i.data.lastLogs&&(this.logs=i.data.lastLogs.filter(t=>t.trim()!=="")),this.isMonitoring&&!this.statusCheckInterval&&this.startStatusChecking()}catch(i){console.error("Durum kontrolü hatası:",i)}},startStatusChecking(){this.statusCheckInterval=setInterval(async()=>{await this.checkMonitoringStatus()},1e4)},showNotification(i,t,n){this.notification.timeout&&clearTimeout(this.notification.timeout),this.notification={show:!0,type:i,title:t,message:n,timeout:setTimeout(()=>{this.notification.show=!1},5e3)}},saveToLocalStorage(){localStorage.setItem("fiyatTakipProducts",JSON.stringify(this.products)),localStorage.setItem("fiyatTakipEmail",JSON.stringify(this.emailSettings))},loadFromLocalStorage(){const i=localStorage.getItem("fiyatTakipProducts"),t=localStorage.getItem("fiyatTakipEmail");i&&(this.products=JSON.parse(i)),t&&(this.emailSettings=JSON.parse(t))},getProductName(i){try{const n=new URL(i).pathname.split("/"),o=n[n.length-1].split("-").join(" ").replace(".html","");return o.charAt(0).toUpperCase()+o.slice(1)}catch{return"Ürün"}},formatDate(i){return new Date(i).toLocaleString("tr-TR")}}},P={class:"py-12"},C={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},S={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},M={class:"p-6 bg-white border-b border-gray-200"},_={class:"mb-8 bg-gray-50 p-6 rounded-lg shadow-inner"},L={class:"mb-4"},z={class:"mb-4"},N={class:"mt-2"},T={class:"inline-flex items-center mr-4"},B={class:"inline-flex items-center"},F={class:"mb-6"},E={class:"flex items-center justify-end"},H={class:"overflow-x-auto"},I={class:"min-w-full bg-white"},j={class:"py-4 px-4 border-b border-gray-200"},V={class:"flex flex-col"},A=["href"],U={class:"text-xs text-gray-500 truncate max-w-xs"},D={class:"py-4 px-4 border-b border-gray-200 text-sm"},O={class:"py-4 px-4 border-b border-gray-200 text-sm"},R={class:"py-4 px-4 border-b border-gray-200 text-sm"},J={key:1,class:"text-gray-500"},K={class:"py-4 px-4 border-b border-gray-200 text-sm"},Z={class:"py-4 px-4 border-b border-gray-200 text-sm"},G=["onClick"],Y={key:0},q={class:"mt-8 bg-gray-50 p-6 rounded-lg shadow-inner"},Q={class:"mb-4"},W={class:"mb-6"},X={class:"flex items-center justify-end"},$={key:0,class:"mt-8 bg-gray-50 p-6 rounded-lg shadow-inner"},tt={key:0,class:"mt-4"},et={class:"bg-gray-800 text-gray-100 p-4 rounded font-mono text-sm overflow-auto max-h-60"},st={class:"mt-8 flex justify-center"},ot=["disabled"],it={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},rt={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},at=["disabled"],nt={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},lt={key:1,xmlns:"http://www.w3.org/2000/svg",class:"h-5 w-5 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},dt={key:1,class:"fixed bottom-5 right-5"},ut={class:"flex items-center"},ct={key:0,class:"text-green-500 rounded-full bg-green-100 mr-3"},gt={key:1,class:"text-red-500 rounded-full bg-red-100 mr-3"},mt={key:2,class:"text-blue-500 rounded-full bg-blue-100 mr-3"},pt={class:"font-bold"};function ht(i,t,n,w,o,l){return a(),r("div",P,[e("div",C,[e("div",S,[e("div",M,[t[35]||(t[35]=e("h1",{class:"text-2xl font-semibold text-gray-800 mb-6"},"Fiyat Takip Uygulaması",-1)),e("div",_,[t[15]||(t[15]=e("h2",{class:"text-xl font-medium text-gray-700 mb-4"},"Yeni Ürün Ekle",-1)),e("div",L,[t[10]||(t[10]=e("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"url"}," Ürün URL ",-1)),u(e("input",{class:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"url",type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>o.newProduct.url=s),placeholder:"https://www.zara.com/tr/tr/..."},null,512),[[g,o.newProduct.url]])]),e("div",z,[t[13]||(t[13]=e("label",{class:"block text-gray-700 text-sm font-bold mb-2"}," Mağaza ",-1)),e("div",N,[e("label",T,[u(e("input",{type:"radio",class:"form-radio","onUpdate:modelValue":t[1]||(t[1]=s=>o.newProduct.store=s),value:"zara"},null,512),[[h,o.newProduct.store]]),t[11]||(t[11]=e("span",{class:"ml-2"},"Zara",-1))]),e("label",B,[u(e("input",{type:"radio",class:"form-radio","onUpdate:modelValue":t[2]||(t[2]=s=>o.newProduct.store=s),value:"pull&bear"},null,512),[[h,o.newProduct.store]]),t[12]||(t[12]=e("span",{class:"ml-2"},"Pull&Bear",-1))])])]),e("div",F,[t[14]||(t[14]=e("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"target_price"}," Hedef Fiyat (TL) ",-1)),u(e("input",{class:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"target_price",type:"number","onUpdate:modelValue":t[3]||(t[3]=s=>o.newProduct.targetPrice=s),placeholder:"499.90"},null,512),[[g,o.newProduct.targetPrice]])]),e("div",E,[e("button",{class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",type:"button",onClick:t[4]||(t[4]=(...s)=>l.addProduct&&l.addProduct(...s))}," Ürün Ekle ")])]),e("div",null,[t[18]||(t[18]=e("h2",{class:"text-xl font-medium text-gray-700 mb-4"},"Takip Edilen Ürünler",-1)),e("div",H,[e("table",I,[t[17]||(t[17]=e("thead",null,[e("tr",null,[e("th",{class:"py-3 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Ürün "),e("th",{class:"py-3 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Mağaza "),e("th",{class:"py-3 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Hedef Fiyat "),e("th",{class:"py-3 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Son Fiyat "),e("th",{class:"py-3 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," Son Kontrol "),e("th",{class:"py-3 px-4 border-b border-gray-200 bg-gray-50 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"}," İşlemler ")])],-1)),e("tbody",null,[(a(!0),r(f,null,b(o.products,(s,c)=>(a(),r("tr",{key:c,class:"hover:bg-gray-50"},[e("td",j,[e("div",V,[e("a",{href:s.url,target:"_blank",class:"text-blue-600 hover:text-blue-900 truncate max-w-xs"},d(l.getProductName(s.url)),9,A),e("span",U,d(s.url),1)])]),e("td",D,d(s.store),1),e("td",O,d(s.targetPrice)+" TL ",1),e("td",R,[s.lastPrice?(a(),r("span",{key:0,class:y({"text-green-600":s.lastPrice<=s.targetPrice,"text-red-600":s.lastPrice>s.targetPrice})},d(s.lastPrice)+" TL ",3)):(a(),r("span",J,"Henüz kontrol edilmedi"))]),e("td",K,d(s.lastCheck?l.formatDate(s.lastCheck):"Henüz kontrol edilmedi"),1),e("td",Z,[e("button",{onClick:ft=>l.removeProduct(c),class:"text-red-600 hover:text-red-900 mr-2"}," Sil ",8,G)])]))),128)),o.products.length===0?(a(),r("tr",Y,t[16]||(t[16]=[e("td",{colspan:"6",class:"py-4 px-4 border-b border-gray-200 text-gray-500 text-center"}," Henüz takip edilen ürün bulunmuyor. ",-1)]))):m("",!0)])])])]),e("div",q,[t[22]||(t[22]=e("h2",{class:"text-xl font-medium text-gray-700 mb-4"},"Email Ayarları",-1)),e("div",Q,[t[19]||(t[19]=e("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"email"}," Email Adresi ",-1)),u(e("input",{class:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"email",type:"email","onUpdate:modelValue":t[5]||(t[5]=s=>o.emailSettings.email=s),placeholder:"ornek@gmail.com"},null,512),[[g,o.emailSettings.email]])]),e("div",W,[t[20]||(t[20]=e("label",{class:"block text-gray-700 text-sm font-bold mb-2",for:"app_password"}," Gmail App Password ",-1)),u(e("input",{class:"shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline",id:"app_password",type:"password","onUpdate:modelValue":t[6]||(t[6]=s=>o.emailSettings.appPassword=s),placeholder:"xxxx xxxx xxxx xxxx"},null,512),[[g,o.emailSettings.appPassword]]),t[21]||(t[21]=e("p",{class:"text-xs italic mt-1"},"Bu uygulama, fiyat bildirimleri için Google hesabınızın App Password'ünü gerektirir.",-1))]),e("div",X,[e("button",{class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline",type:"button",onClick:t[7]||(t[7]=(...s)=>l.saveEmailSettings&&l.saveEmailSettings(...s))}," Ayarları Kaydet ")])]),o.isMonitoring?(a(),r("div",$,[t[24]||(t[24]=e("h2",{class:"text-xl font-medium text-gray-700 mb-4"},"Takip Durumu",-1)),t[25]||(t[25]=e("div",{class:"flex items-center mb-4"},[e("div",{class:"w-3 h-3 bg-green-500 rounded-full mr-2 animate-pulse"}),e("span",{class:"text-green-600 font-medium"},"Fiyat takibi aktif")],-1)),o.logs.length>0?(a(),r("div",tt,[t[23]||(t[23]=e("h3",{class:"text-md font-medium text-gray-700 mb-2"},"Son Log Kayıtları",-1)),e("div",et,[(a(!0),r(f,null,b(o.logs,(s,c)=>(a(),r("div",{key:c,class:"mb-1"},d(s),1))),128))])])):m("",!0)])):m("",!0),e("div",st,[o.isMonitoring?(a(),r("button",{key:1,onClick:t[9]||(t[9]=(...s)=>l.stopMonitoring&&l.stopMonitoring(...s)),class:"bg-red-500 hover:bg-red-700 text-white font-bold py-3 px-6 rounded-lg focus:outline-none focus:shadow-outline flex items-center",disabled:o.loading},[o.loading?(a(),r("svg",nt,t[29]||(t[29]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(a(),r("svg",lt,t[30]||(t[30]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 10a1 1 0 011-1h4a1 1 0 011 1v4a1 1 0 01-1 1h-4a1 1 0 01-1-1v-4z"},null,-1)]))),t[31]||(t[31]=x(" Fiyat Takibini Durdur "))],8,at)):(a(),r("button",{key:0,onClick:t[8]||(t[8]=(...s)=>l.startMonitoring&&l.startMonitoring(...s)),class:"bg-green-500 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg focus:outline-none focus:shadow-outline flex items-center",disabled:o.loading},[o.loading?(a(),r("svg",it,t[26]||(t[26]=[e("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),e("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):(a(),r("svg",rt,t[27]||(t[27]=[e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z"},null,-1),e("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 12a9 9 0 11-18 0 9 9 0 0118 0z"},null,-1)]))),t[28]||(t[28]=x(" Fiyat Takibini Başlat "))],8,ot))]),o.notification.show?(a(),r("div",dt,[e("div",{class:y(`px-6 py-4 rounded-lg shadow-lg max-w-sm ${o.notification.type==="success"?"bg-green-100 border-l-4 border-green-500 text-green-700":o.notification.type==="error"?"bg-red-100 border-l-4 border-red-500 text-red-700":"bg-blue-100 border-l-4 border-blue-500 text-blue-700"}`)},[e("div",ut,[o.notification.type==="success"?(a(),r("div",ct,t[32]||(t[32]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M9 12L11 14L15 10M12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12C22 17.5228 17.5228 22 12 22Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))):o.notification.type==="error"?(a(),r("div",gt,t[33]||(t[33]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M12 8V12M12 16H12.01M22 12C22 17.5228 17.5228 22 12 22C6.47715 22 2 17.5228 2 12C2 6.47715 6.47715 2 12 2C17.5228 2 22 6.47715 22 12Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))):(a(),r("div",mt,t[34]||(t[34]=[e("svg",{width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg"},[e("path",{d:"M13 16H12V12H11M12 8H12.01M21 12C21 16.9706 16.9706 21 12 21C7.02944 21 3 16.9706 3 12C3 7.02944 7.02944 3 12 3C16.9706 3 21 7.02944 21 12Z",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round"})],-1)]))),e("div",null,[e("p",pt,d(o.notification.title),1),e("p",null,d(o.notification.message),1)])])],2)])):m("",!0)])])])])}const yt=k(v,[["render",ht]]);export{yt as default};
